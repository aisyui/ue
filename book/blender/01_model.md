# 素体を作る

素体を作ります。できる限り現実に近い再現を目指します。これを`gender system`と呼び、わかりやすくいうとキャラクターの性器システムです。なお、ここの素体はアイではありません。

今回は、Aモデル(vrm)とBモデル(部位)の統合をblenderで行います。統合したものをvrmにexportして、ueでimportします。Bモデルにはシェイプキーを設定しているので、ueではモーフターゲットとして動かせるようにします。

ueで動かすにはmaterialに`VRM MToon`を使うこと、`UVMap`の名前に設定すること、`vrm0`を使うこと、データ転送で`頂点`を設定することが大切です。今回使用する[addon](/blender/)は、vrmをimport, exportするaddonだけです。

## vroidの設定

素体はvroidをベースにします。つけている衣装を全部はずします。そして、パンツなどもテクスチャを削除しておくと素体の完成です。

## materialの設定

vrmをblenderで読み込みます。

1. Bモデルのmaterialに`VRM MToon`を設定します。ueでimportする際にcrashします。
2. dataのUVマップに`UVMap_xxx`となっているときは名前を`UVMap`にします。色がおかしくなります。

## 基本的な編集(移動、削除、位置)

1. Bモデルを正しい位置にセットします。[G], [Z], [R]
2. Aモデルを適切に切り取ります。[面を選択], [細分化], [四角形に], [面を削除]
3. シェイプキーを動かしても問題ないかの確認します。

![](/img/0012.png)

## bodyに追従させる

このままではBモデルは体に追従しません。追従させるには頂点をアーマチュア(armature)に追加します。

1. Bモデルのモディファイアから[データ転送], [Body(J_Bip_C_Hips)], [頂点], [頂点グループ]を選択し、[データレイヤーを生成], [適用]します。
2. Bモデルのモディファイアでアーマチュアで[Armature]を追加します。
3. 女性の場合はボーン(足)を調整します。なお、少し浮くようになってしまうため全体を-Zします。[G], [X], [R]

> シェイプキーをueでも有効にするには、vrm0を使います。また、編集しているときにobjectを分離した場合は元の構成に再統合してください。

![](/img/0013.png)

## gender systemについて

gender systemの廃止と考え方。現実の反映、見えない部分もしっかり作ること、インディーズゲームは何が話題になるかわからないこと。大企業がやらないようなことで勝負していく必要があること。性は人間とは切り離せない要素であること、などから少しの間、実装を検討していました。

つまり、エロがテーマだからつけよう。ファンタジーがテーマだから必要ない、面倒だし問題になってもよくない。そういう話ではなく、必要、不要にかかわらず、本来の価値観を基準に判断すべきであるということです。しかし、結局のところ面倒だしモチベも一切ないしで、廃止が決定されています。

アイはもともと性別を決めていないキャラでした。ここの素体もアイではありません。しかし、それ以外のキャラ、例えば、ドラゴンなんかにも、これは男性、これは女性という意識がありました。

[issue: ueで読み込むと一部のmaterialが正しく表示されない](/issue/blender/blender_02.html)

