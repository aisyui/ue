# vrmと統合する

`.vrm`を読み込んで、別の`.vrm`を統合する方法です。

各部位を動かすには衣装を着せる方法で使った`データ転送`を使います。

例えば、髪の毛を入れ替えてみましょう。

ここで重要なのは髪の毛の物理シュミレーションです。髪の毛が動かないのは、物理シュミレーションの設定がなくなっているからで、vrm 1.0を前提にしますが、統合すると`Spring Bone`の設定が消えています。

次に、設定されているウェイトが剥がされる可能性があります。データ転送する際は確認してください。

- 物理シュミレーションはあるか。blenderで設定しない場合はueの`kawaiiphysics`で設定すればいい。
- ウェイトはあるか。これがないと一から設定しなければならず、できれば設定を引き継ごう。

## 具体的な手順

hair(髪の毛)とbody(体)で分けられたvrmを読み込むこととします。これを統合します。

1. まず、boneの統合を行います。boneはarmatureというようです。不要なboneを削除します。そして、完成版となるarmatureを最後に選択して統合します。
2. 次に必要なboneをつなぎます。boneを編集モードで編集し、`Head` -> `J_Bip_C_Head`を選択し、親を`オフセット維持`で設定します。
3. 次にhairを選択し、モディファイアからデータ転送を行います。ソースにbody, 頂点グループに`J_Bip_C_Head`を選択します。ここが特に重要です。そして、頂点データにチェックを入れ、頂点グループを選択します。最後にデータレイヤーを生成し、適用します。
4. これでhairとbodyがつながった状態になりました。bodyが主体になります。
5. 次にhairを動くようにします。ueでvrmを読み込んで、`ABP_Post_${name}`を編集します。`kawaiiphysics`でRoot Boneに`J_Sec_Hair_1_xx`を1-12まで入れて、Capsule Limitsに`Chest`, `Hip`などを設定します。私は`Chest`の値を大きめにして対処しました。
6. 次に、服が体に入りこまないようにしなければなりません。これも先ほどと同じように設定します。

